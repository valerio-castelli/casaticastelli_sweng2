@startuml

title sd_reserve

activate PassengerApp
PassengerApp ->> RemoteServicesInterface: reserveTaxi(passengerId, origin, destination, date, time)

activate RemoteServicesInterface
PassengerApp <<-- RemoteServicesInterface
RemoteServicesInterface ->> ReservationManagement: reserveTaxi(passengerId, origin, destination, date, time)

activate ReservationManagement
RemoteServicesInterface <<-- ReservationManagement:

deactivate RemoteServicesInterface
ReservationManagement -> ReservationManagement: checkDataConsistency(origin, destination, date, time)

alt correct data
	ReservationManagement -> DataAccessUtilities: insertNewReservation(reservation)
	
	activate DataAccessUtilities
	DataAccessUtilities -> DBMS: insert(...)
	
	activate DBMS
	DataAccessUtilities <-- DBMS
	
	deactivate DBMS
	ReservationManagement <-- DataAccessUtilities
	
	deactivate DataAccessUtilities
	NotificationSystem <<- ReservationManagement: confirmReservation(passengerId, reservation)
	
	activate NotificationSystem
	ReservationManagement <<-- NotificationSystem
	PassengerApp <<- NotificationSystem: confirmReservation(passengerId, reservation)
	PassengerApp -->> NotificationSystem
	
	deactivate NotificationSystem
else wrong data

	ReservationManagement ->> NotificationSystem: notifyErrorInReservation(passengerId)
	
	activate NotificationSystem
	ReservationManagement <<-- NotificationSystem
	PassengerApp <<- NotificationSystem: notifyErrorInReservation(passengerId)
	PassengerApp -->> NotificationSystem
	
	deactivate NotificationSystem
end

deactivate PassengerApp
deactivate ReservationManagement
@enduml 