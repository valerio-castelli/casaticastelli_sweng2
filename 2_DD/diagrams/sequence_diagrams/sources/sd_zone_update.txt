@startuml

title sd_zone_update

[-> AdministrationWebApp: //open zone update form//

activate AdministrationWebApp
AdministrationWebApp -> RemoteServicesInterface: askZoneList(adminId)

activate RemoteServicesInterface
RemoteServicesInterface -> ZoneManagement: askZoneList(adminId)

activate ZoneManagement
ZoneManagement --> RemoteServicesInterface: zoneList

deactivate ZoneManagement
RemoteServicesInterface --> AdministrationWebApp: zoneList

deactivate RemoteServicesInterface
[<- AdministrationWebApp: //show form//

loop until confirmation or exit
	[-> AdministrationWebApp: //data insertion//
	AdministrationWebApp -> RemoteServicesInterface: sendData(data)

	activate RemoteServicesInterface
	RemoteServicesInterface -> ZoneManagement: sendData(data)

	activate ZoneManagement

	ZoneManagement -> ZoneManagement: checkZonesConsistency(data)
	alt correct data
		ZoneManagement --> RemoteServicesInterface: confirmationMessage
		RemoteServicesInterface --> AdministrationWebApp: confirmationMessage
		
		[<- AdministrationWebApp: //show confirmation//
		[-> AdministrationWebApp: //insert password//
		
		AdministrationWebApp -> RemoteServicesInterface: sendPassword(psw)
		RemoteServicesInterface -> ZoneManagement: sendPassword(psw)
		
		ZoneManagement <<-- NotificationSystem
		NotificationSystem ->> AdministrationWebApp: askPassword()
		NotificationSystem <<-- AdministrationWebApp
		
		deactivate NotificationSystem
		[<- AdministrationWebApp: askPassword()
		[-> AdministrationWebApp: insertPassword(psw)
		AdministrationWebApp --> RemoteServicesInterface: sendPassword(adminId, psw)
		AdministrationWebApp <<-- RemoteServicesInterface
		RemoteServicesInterface ->> ZoneManagement: sendPassword(adminId, psw)
		RemoteServicesInterface <<-- ZoneManagement
		ZoneManagement -> ZoneManagement: ckeckPassword(psw)
		alt password confirmed
			ZoneManagement -> DataAccessUtilities: updateZone(...)
			
			activate DataAccessUtilities
			DataAccessUtilities -> DBMS: update(...)
			
			activate DBMS
			DataAccessUtilities <-- DBMS
			
			deactivate DBMS
			ZoneManagement <-- DataAccessUtilities
			
			deactivate DataAccessUtilities
			ZoneManagement ->> NotificationSystem: confirm()
			
			activate NotificationSystem
			ZoneManagement <<-- NotificationSystem
			NotificationSystem ->> AdministrationWebApp: confirm()
			NotificationSystem <<-- AdministrationWebApp
			
			deactivate NotificationSystem
		else password rejected
			ZoneManagement ->> NotificationSystem: reject()
			
			activate NotificationSystem
			ZoneManagement <<-- NotificationSystem
			NotificationSystem ->> AdministrationWebApp: reject()
			NotificationSystem <<-- AdministrationWebApp
			
			deactivate NotificationSystem
		end
	else wrong data
		ZoneManagement ->> NotificationSystem: dataError(...)
			
			activate NotificationSystem
			ZoneManagement <<-- NotificationSystem
			NotificationSystem ->> AdministrationWebApp: dataError(...)
			NotificationSystem <<-- AdministrationWebApp
			
			deactivate NotificationSystem
	end
end

deactivate AdministrationWebApp
deactivate ZoneManagement
	
@enduml