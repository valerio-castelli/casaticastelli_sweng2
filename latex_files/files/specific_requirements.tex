\section{External Interface Requirements}
\section{Functional Requirements}
\section{Performance Requirements}
\section{Design Constraints}
\section{Software System Attributes}
\subsection{Reliability}
\subsection{Availability}
\subsection{Security}
\subsection{Maintainability}
\subsection{Portability}
\section{Other Requirements}




\section{Goals and requirements}
\subsection{Goal 1}
Goal 1: The city administration must have the possibility to enter the data about the taxi drivers and about the taxi zones. 

Requirements:
\begin{itemize}
\item The system must provide a data entry form to collect data about the taxi drivers. In particular, the following information is required for each taxi driver: name, surname, mobile phone number, code/identifier, taxi driver license, taxi license plate.
\item The system must provide a way to specify the taxi zone division of the city. 
\item The system must provide a way for the operator to confirm that the initial data entry operation is complete. 
\item The system will not allow any operation to take place until data entry is marked as completed. 
\end{itemize}

\subsection{Goal 2}
Goal 2: The city administration must have the possibility to update taxi driver data.

Requirements:
\begin{itemize}
\item The system should provide a way to update existing taxi driver data. 
\item The system should provide a way to remove a taxi driver from the list.
\item The system should provide a way to insert a new taxi driver.
\end{itemize}

\subsection{Goal 3}
Goal 3: The city administration must have the possibility to update the taxi zone division.

Requirements:
\begin{itemize}
\item The system must provide a way to update the boundaries of an existing taxi zone. 
\item The system must provide a way to insert a new taxi zone.
\item The system must provide a way to remove an existing taxi zone.
\end{itemize}

\subsection{Goal 4}
Goal 4: The taxi driver must be able to communicate his availability status.

Requirements:
\begin{itemize}
\item The mobile application should implement a toggle to allow drivers to switch their availability status.
\item A taxi driver that has marked himself as available should only be able to mark himself as unavailable. 
\item A taxi driver that has marked himself as unavailable should only be able to mark himself as available. 
\item A taxi driver should be able to mark himself as available only if it’s inside the city. 
\item A taxi driver who is currently on a ride should not be able to mark himself as unavailable. 
\item When a taxi driver marks himself as available, the mobile application should send his GPS coordinates to the central system.
\item When a taxi driver marks himself as available, the system should use the retrieved GPS coordinates to compute the taxi zone to which the taxi belongs and move its code into the last position of the corresponding queue. 
\item If the system successfully registers a taxi driver as available, it should send him a positive notification on the mobile application. Otherwise, it should send him a negative notification and ask him to retry later.
\item When a taxi driver marks himself as unavailable while being inside the city, his taxi code should be removed from the queue of the corresponding zone.
\item When a taxi driver marks himself as unavailable, his internal status should be updated accordingly. 
\item When a taxi driver is set as unavailable, he should receive a notification warning him that he’s no longer available to accept requests.
\end{itemize}

\subsection{Goal 5}
Goal 5: The allocation and distribution of taxis should be managed fairly and consistently.

Requirements:
\begin{itemize}
\item The system should consider all drivers to be initially (?) unavailable by default.
\item The unavailability status of a taxi driver should not be affected by him leaving or entering the city.
\item Each taxi zone must be internally associated with a queue containing the codes of the available taxis.
\item The system must be able to distinguish the different states in which a taxi could be: that is available, unavailable, currently on a ride, out of the city.
\item If a taxi which has marked himself as available changes zone while he’s not on a ride, the system should move his code in the queue of the new zone. 
\item If a taxi which is currently on a ride changes zone, the system should not add his code in the queue of the new zone and his status should remain “currently riding”.
\item If a taxi which has marked himself as available exits the city while he’s not on a ride, the system should update his status accordingly.
\item If a taxi which is currently on a ride exits the city, the system should keep his status as “currently riding”. 
\item If a taxi whose status is set as “out of the city“  enters the city and the taxi was available before leaving the city and he has not marked himself as unavailable, the system should assign it to the queue of the zone in which he has entered.
\item If a taxi whose status is set as “out of the city” enters the city and the taxi has signaled himself as unavailable while he was out, the system should set its status as “unavailable”. 
\item If a taxi leaves the city while he’s unavailable, the system should prevent him from signaling he’s available until he is again in the perimeter of the city.
\item The mobile application of each taxi driver should periodically send his GPS coordinates to the main system. 
\end{itemize}

\subsection{Goal 6}
Goal 6: The taxi driver should be able to receive, accept and refuse ride requests.

Requirements:
\begin{itemize}
\item The taxi driver that has been selected for a ride should receive a notification containing details on the meeting location and be allowed to accept or refuse the request.
\item The system should be able to reverse-decode the GPS coordinates of the meeting location into a valid city address.
\item The system should provide an appropriate interface to let the driver accept or refuse the ride request.
\item If a taxi driver accepts a request for a ride, the system should update its taxi status to “currently riding”.
\item If a taxi driver refuses a request for a ride, his taxi code should be moved to the last position of the queue of the zone he’s currently in.
\item If the selected taxi driver does not answer within two minutes from the assignment, the system should consider the request refused. 
\item If it’s not possible to establish an internet connection to the central system, the mobile application should notify the taxi driver that it’s unable to operate correctly.
\end{itemize}

\subsection{Goal 7}
Goal 7: The taxi driver should be able to drop a request if the passenger doesn’t show up.

Requirements:
\begin{itemize}
\item If a passenger who has requested a ride doesn’t show up at the meeting location, the system should allow the taxi driver to drop the request. 
\item In order for the “drop request” functionality to be enabled, the system should check that the taxi driver has effectively reached the meeting point.
\item If a taxi driver uses the “drop request” functionality, the system should notify the passenger that his request has been dropped.
\end{itemize}

\subsection{Goal 8}
Goal 8: The taxi driver should be able to communicate he has terminated a ride.

Requirements:
\begin{itemize}
\item A taxi driver who has terminated a ride should be able to notify the system that the ride has ended.
\item A taxi driver should be able to notify that he’s terminated a ride only after the system has checked that the meeting point has actually been reached within a given level of precision. (?) 
\item When the system receives the notification that a driver has terminated a ride and the driver is still outside the city, the system should set its status as “out of the city”.
\item When the system receives the notification that a driver has terminated a ride and the driver is inside the city, the system should assign him to the queue of the zone in which he is.
\end{itemize}

\subsection{Goal 9}
Goal 9: Users should be able to request rides.

Requirements:
\begin{itemize}
\item The system should not allow for requests to have an origin outside the city. 
\item The system should provide a way for users to request a ride.
	- The mobile application should be able to detect the current GPS location and use it as the source point of a ride request.
	- The mobile application should allow the user to enter an address as the source point of a ride request.
	- The web application should allow the user to enter an address as the source point of a ride request.
\item If it’s not possible to retrieve the GPS location of the passenger (either because there is no satellite coverage or because the authorization to use location services has been refused), the system should notify the user that it’s unable to automatically locate his position.
\item If it’s not possible to establish an internet connection to the central system, the mobile application should notify the user that it’s unable to operate correctly.
\item In case the internet connection goes down at any point during the request process, the mobile application should abort the process and notify the user that the request could not be completed.
\item When a user requests a ride, the system should use the source field of the request to compute the corresponding taxi zone. 
\item After a request’s taxi zone has been computed, the system should assign the request to the first taxi in that zone’s queue.
\item If a taxi driver accepts a request for a ride, the system should send a notification to the requesting user containing the code of the incoming taxi and an estimation of the waiting time (ETA).
\item If the selected taxi driver refuses the request, the system should move his taxi code to the last position of the queue and forward the request to the following taxi in the queue.
\item If the system is not able to find any available taxi in the queue of the specified zone, it should notify the passenger that the request could not be fulfilled. 
\end{itemize}

\subsection{Goal 10}
Goal 10: Users should be able to register.

Requirements:
\begin{itemize}
\item The system should provide a registration form. (including which data?)
\end{itemize}

\subsection{Goal 11}
Goal 11: Registered users should be able to reserve rides in advance.

Requirements:
\begin{itemize}
\item The system should keep an association between a user profile and his reservations.
\item The system should provide a way for registered users to reserve a ride for a specific date and time.
	- The mobile application should allow the user to enter the source and destination addresses for the ride and the meeting time.
	- The web application should allow the user to enter the source and destination addresses for the ride and the meeting time.
\item If it’s not possible to establish an internet connection to the central system, the mobile application should notify the user that it’s unable to operate correctly.
\item In case the internet connection goes down at any point during the reservation process, the mobile application should abort the process and notify the user that the request could not be completed.
\item The system should provide a way for registered users to review their active reservations.
\item The system should provide a way for registered users to delete a reservation.
\item The system should store reservations in a reservation queue. 
\item For every stored reservation, the system should proceed with selecting a taxi only 10 minutes before the scheduled meeting time.
\item For every stored reservation, the system should only select taxis from the queue of the zone associated with the source address.
\item The system should not allow a reservation to be scheduled if there aren’t at least two hours between the desired meeting time and the moment when the reservation request is submitted. 
\item The system should not allow a reservation to be scheduled more than 15 days in advance.
\item Reservations can’t be deleted after a taxi has already been associated to them.
\item If no taxis are available to fulfill a reservation 10 minutes before the scheduled meeting time, the system should attempt to reschedule it at intervals of 5 minutes for at most 10 times.
\item If a reservation can’t be fulfilled after 10 reschedules, the system should notify the passenger that his reservation will be dropped. 
\end{itemize}

\subsection{Goal 12}
Goal 12: The taxi driver associated with a ride request or reservation can only take onboard the passenger who actually requested the ride.

Requirements:
\begin{itemize}
\item For each ride request, the system should generate a random 4 digit security number.
\item The security number must be sent to the taxi driver upon his confirmation that he will take care of the ride.
\item The security number must be sent to the passenger who requested the ride (?).
\end{itemize}

\section{Scenarios}
SOME POSSIBLE SCENARIOS
(with a template of event flow for the sequence diagram)
\subsection{Scenario 1}
Alice has just got out of her office after an intense day of work. Unfortunately she finished late and so she missed the last train back home.

She decides then to request a taxi. She opens the taxi application on her mobile phone and she clicks on the “request a taxi for this location” button.

The mobile application detects her GPS location, creates a taxi request and forwards it to the central system.

The system receives the taxi request, extracts the GPS coordinates and realizes that Alice is in zone 2. Thus, it forwards a request to the first taxi in the queue associated with zone 2, which happens to be Bob’s taxi.

Bob receives a request notification on his mobile terminal, which employs the associated GPS information to point out Alice’s location on the city map. Bob decides to accept the request and clicks on the “accept request” button.

The system receives Bob’s confirmation along with his GPS coordinates and moves his taxi code from the zone 2 queue to the “currently riding” list; it then uses this information to retrieve from an external mapping service an estimate time of arrival (ETA) and notifies it to Alice along with the taxi code of Bob’s taxi and a security code associated with the ride. The system also notifies Bob the security code associated with the ride; then Bob starts driving.

Alice receives the notification on her mobile phone and patiently waits for the taxi to arrive.

When Bob’s taxi arrives, Alice tells Bob the security code and the taxi code she received from the system. Bob checks they correspond to his own and let Alice get on the car.


\subsection{Scenario 2}
Jessica and Davide are planning to celebrate their anniversary, which is happening in a week, by going out and have dinner at a very expensive restaurant.

Since they probably would end up being drunk after the night, they decide it would be better to avoid driving and they decide instead to reserve a taxi.

Davide opens the taxi reservation web page on his laptop and logins using his credentials (he’s a proud taxi user!). He then clicks on the “reserve a taxi” button and fills in the required details for the reservation: the departing address, the destination address and the date and time of the meeting. He then confirms.

The system receives the request and stores it into the list of reservations, then sends a confirmation back to Davide’s laptop.

Davide receives the confirmation and is assured that the system will handle his request.


\subsection{Scenario 3}
On the night of their anniversary, Jessica and Davide are getting ready to leave.

10 minutes before the scheduled meeting time, the system uses the specified departing address to compute the zone associated with Davide’s apartment and realizes he lives in zone 4. It then forwards the request to the the first taxi in the queue associated with zone 4, which happens to be Matteo’s taxi.

Matteo receives a request notification on his mobile terminal, which employs the associated GPS information to point out Davide’s apartment location on the city map. Matteo decides to accept the request and clicks on the “accept request” button.

The system receives Matteo’s confirmation along with his GPS coordinates and moves his taxi code from the zone 4 queue to the “currently riding” list; it then uses this information to retrieve from an external mapping service an estimate time of arrival (ETA) and notifies it to Davide along with the taxi code of Matteo’s taxi and a security code associated with the ride. The system also notifies Matteo the security code associated with the ride, then Matteo starts driving.

Davide receives the notification on her mobile phone and patiently waits for the taxi to arrive.

When Matteo’s taxi arrives, Davide tells Matteo the security code and the taxi code he received from the system. Matteo checks they correspond to his own and let Davide and Jessica get on the car.


\subsection{Scenario 4}
Matteo has just drove Davide and Jessica to their destination, which is a restaurant in the middle of the city. He clicks the “confirm ride ended” button in the mobile application. The mobile application sends a notification message to the central system, which acknowledges that the ride has ended.

Since Matteo was previously available before the ride and has not switched the available/unavailable toggle, the system computes the zone associated with his current GPS coordinates and moves his taxi code into the last position of the respective queue.


\subsection{Scenario 5}
Bob has just drove Alice back to her apartment, which is a small flat in the suburbs (but still belonging to the city). He clicks the “confirm ride ended” button in the mobile application. The mobile application sends a notification message to the central system, which acknowledges that the ride has ended.

Since Bob was previously available before the ride and has not switched the available/unavailable toggle, the system computes the zone associated with his current GPS coordinates and moves his taxi code in the respective code, in the last position.

At this point, however, Bob feels a little tired and decides to take a nap, so he switches the available/unavailable toggle to the unavailable position.

The mobile application sends a notification to the central system, which acknowledges Bob’s decision and proceeds to move his taxi code from the queue of his current zone to the unavailability queue. It then sends back a notification to Bob informing him that he’s been correctly registered as unavailable and that he will not be able to receive further requests as long as he remain so.

Bob can now take some well deserved rest.


\subsection{Scenario 6}
Frank, a taxi driver, has just picked up Samuel from a very famous hotel in the city.

During their journey to the airport, which is Samuel’s destination, Frank has to cross the city border: in fact, the airport is located just outside the city.

After leaving Samuel at the airport, Frank clicks the “confirm ride ended” button in the mobile application.

The mobile application sends a notification to the central system, which acknowledges that the ride has ended.

Since Frank is now located outside the city, the system moves his taxi code into the “out-of-city” queue.


\subsection{Scenario 7}
As soon as Frank crosses the city border the mobile application, which has been continually sending GPS location data to the central system for the whole journey, sends a notification to the central system containing the new location data.

The system determines that Frank’s current location is now inside the boundaries of the city and computes the associated zone.

Since Frank had flagged himself as available before accepting Samuel’s request and has not switched the available/unavailable toggle for the whole journey, the system moves his taxi code into the last position of the computed zone’s queue. 


\subsection{???}
A user requests a taxi:
- A user access the app (mobile or web?)
- The user request a taxi
- The system receive the request
- The system, by interaction with the mapping serve, compute in which zone the user is
- The system checks if in this zone there is a taxi available; let's suppose there is one (or do we have to consider also the other case?)
- The system sends to the taxi driver a notification (with which info???)
- The taxi driver accepts
- The system receive the confirmation
- The system remove the taxi driver from the queue and put it on the UL
- The system sends a notification to the user with taxi code and waiting time
- The user receive the confirm

A user books/reserves a ride:
- The user open the web app
- The user log in
- The user open the form to reserve a taxi
- The user insert all the requested info
- The user confirm
- The system receive the request
- The system store the request (???)

A taxi driver has ended a ride and wants to communicate his availability:
- The taxi driver sends a notification of "ride endend"
- The system receive it and delete the request of the user (?)
- The taxi driver sends a message of "available"
- The system receive it
- The system compute the taxi driver position (by the mean of the mapping service ?)
- The system put the taxi code in the zone queue

A user withdraw / delete a book / ... (one of this will be enough ???)

A taxi driver withdraw / ... (one of this will be enough ???)

A taxi driver enter in city

A taxi driver changes zone / leaves the city

10 minutes before a meeting time, the system associates a taxi to the reservation